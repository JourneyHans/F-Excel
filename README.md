# F-Excel 桌面应用程序

一个模块化的桌面工具集合，提供各种实用的数据处理功能。采用现代化的软件架构设计，遵循SOLID原则和多种设计模式，实现了高内聚、低耦合的模块化系统。

## 🚀 项目特性

- **模块化设计**: 采用插件化架构，易于扩展新功能
- **现代化架构**: 遵循SOLID原则，使用多种设计模式
- **高性能处理**: 支持大文件异步处理和批处理
- **用户友好**: 直观的图形界面，完善的错误处理
- **跨平台支持**: 支持Windows、Linux、macOS
- **类型安全**: 完整的类型注解，提高代码质量

## 🏗️ 架构设计

### 设计模式应用
- **分层架构模式**: 表现层、业务逻辑层、数据访问层分离
- **模块化设计模式**: 插件式架构，支持动态模块加载
- **策略模式**: 不同类型数据使用不同处理策略
- **工厂模式**: 动态创建模块和处理器实例
- **模板方法模式**: 定义算法骨架，子类实现具体步骤
- **观察者模式**: 进度更新和状态通知
- **单例模式**: 确保应用实例唯一性

### 技术架构
```
┌─────────────────────────────────────────────────────────────┐
│                        表现层 (Presentation Layer)           │
├─────────────────────────────────────────────────────────────┤
│  main.py (FExcelApp) - 主界面管理和模块调度                │
└─────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────┐
│                      业务逻辑层 (Business Logic Layer)        │
├─────────────────────────────────────────────────────────────┤
│  modules/ - 核心功能模块包                                  │
│  ├── base_module.py - 基础模块抽象类                       │
│  ├── data_processors.py - 数据处理策略                     │
│  ├── id_converter.py - ID值转换器                          │
│  └── excel_translator.py - Excel翻译器                     │
└─────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────┐
│                      数据访问层 (Data Access Layer)           │
├─────────────────────────────────────────────────────────────┤
│  pandas, openpyxl, file I/O - 数据读写和格式转换           │
└─────────────────────────────────────────────────────────────┘
```

## 📦 功能模块

### 🔢 模块1：ID值转换器
- **功能**: 将【id=值】格式的文本转换为两列Excel文件
- **特性**: 
  - 支持批量处理和文件导入导出
  - 实时数据预览和验证
  - 智能文件名生成
- **支持格式**: 文本文件(.txt)、CSV文件(.csv)
- **输出格式**: Excel文件(.xlsx)

### 🌐 模块2：Excel翻译器
- **功能**: 将Excel文件中的ID、中文、韩文三列转换为ID=韩文格式
- **特性**:
  - 支持Excel文件导入和文本文件导出
  - 支持制表符分隔的文本数据输入
  - 大文件异步处理，避免界面冻结
  - 进度显示和取消处理
- **支持格式**: Excel文件(.xlsx, .xls)
- **输出格式**: 文本文件(.txt)

## 🛠️ 技术栈

### 核心框架
- **Python 3.7+**: 主要开发语言
- **tkinter**: GUI框架，跨平台支持
- **pandas**: 数据处理和分析库
- **openpyxl**: Excel文件操作库
- **pillow**: 图像处理库

### 开发工具
- **类型注解**: 使用typing模块，提高代码质量
- **代码规范**: 遵循PEP 8 Python代码风格指南
- **文档字符串**: 详细的函数和类文档
- **错误处理**: 完善的异常处理机制

## 📋 安装说明

### 系统要求
- Python 3.7 或更高版本
- 至少 4GB 内存
- 100MB 可用磁盘空间

### 安装步骤

1. **克隆项目**
   ```bash
   git clone https://github.com/your-username/F-Excel.git
   cd F-Excel
   ```

2. **创建虚拟环境** (推荐)
   ```bash
   python -m venv venv
   
   # Windows
   venv\Scripts\activate
   
   # Linux/macOS
   source venv/bin/activate
   ```

3. **安装依赖包**
   ```bash
   pip install -r requirements.txt
   ```

4. **运行应用**
   ```bash
   python main.py
   ```

### 快速启动脚本
- **Windows**: 双击 `start.bat`
- **Linux/macOS**: 运行 `./start.sh`

## 🚀 使用方法

### 启动应用
运行主程序后，会显示主界面，包含所有可用模块的卡片式展示。

### ID值转换器使用
1. 点击"ID值转换器"模块卡片
2. 选择文本文件或直接输入数据
3. 点击"转换并预览"查看结果
4. 点击"导出Excel"保存文件

### Excel翻译器使用
1. 点击"Excel翻译器"模块卡片
2. 选择Excel文件或直接输入数据
3. 点击"转换并预览"查看结果
4. 点击"导出文本文件"保存文件

### 数据格式要求

#### ID值转换器输入格式
```
410325=提升{0}
410326=降低{0}
410327=无变化
410328=高于
410329=等于
410330=低于
```

#### Excel翻译器输入格式
```
999470001	反馈问题	피드백
999470002	画质:	해상도:
999470003	上传日志:	로그 업로드:
```

## 🔧 配置说明

### 配置文件
主要配置在 `config.py` 文件中，包括：
- 应用程序信息
- 窗口配置
- 文件配置
- 样式配置
- 性能配置
- 正则表达式模式

### 环境变量支持
支持通过环境变量覆盖配置：
```bash
# 设置日志级别
export FEXCEL_LOG_LEVEL=DEBUG

# 设置批处理大小
export FEXCEL_BATCH_SIZE=2000
```

## 📚 开发指南

### 添加新模块
1. 在 `modules/` 目录下创建新的模块文件
2. 继承 `BaseModule` 类并实现必要方法
3. 在 `modules/__init__.py` 中注册新模块
4. 更新模块配置和界面

### 添加新数据处理器
1. 继承 `DataProcessor` 类
2. 实现数据处理逻辑
3. 在 `DataProcessorFactory` 中注册

### 代码规范
- 遵循 PEP 8 代码风格
- 使用类型注解
- 编写详细的文档字符串
- 完善的错误处理

## 🧪 测试

### 运行测试
```bash
# 运行所有测试
python -m pytest

# 运行特定测试文件
python -m pytest tests/test_id_converter.py

# 生成覆盖率报告
python -m pytest --cov=modules tests/
```

### 测试覆盖
- 单元测试：模块功能测试
- 集成测试：端到端工作流程测试
- 性能测试：大文件处理性能测试

## 📈 性能优化

### 大文件处理
- 分块读取和处理
- 异步处理避免界面冻结
- 内存使用监控和限制

### 批处理
- 批量数据处理
- 进度更新和取消支持
- 多线程处理

### 缓存机制
- 文件内容缓存
- 处理结果缓存
- 内存使用优化

## 🐛 故障排除

### 常见问题

#### 1. 模块启动失败
- 检查Python版本是否为3.7+
- 确认所有依赖包已正确安装
- 查看错误日志获取详细信息

#### 2. 大文件处理缓慢
- 启用异步处理模式
- 调整批处理大小
- 检查系统内存使用情况

#### 3. 文件编码问题
- 确保文件使用UTF-8编码
- 尝试其他编码格式（GBK、GB2312等）
- 检查文件是否损坏

### 日志查看
应用运行时会生成日志文件 `f_excel.log`，包含详细的运行信息和错误记录。

## 🤝 贡献指南

### 贡献方式
1. Fork 项目
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 打开 Pull Request

### 贡献要求
- 遵循项目代码规范
- 添加必要的测试
- 更新相关文档
- 确保所有测试通过

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## 👥 团队成员

- **项目负责人**: F-Excel Team
- **主要开发者**: F-Excel Team
- **测试人员**: F-Excel Team

## 📞 联系方式

- **项目主页**: [GitHub Repository](https://github.com/your-username/F-Excel)
- **问题反馈**: [Issues](https://github.com/your-username/F-Excel/issues)
- **功能建议**: [Discussions](https://github.com/your-username/F-Excel/discussions)

## 🙏 致谢

感谢所有为这个项目做出贡献的开发者和用户！

---

**F-Excel** - 让数据处理更简单、更高效！ 🚀
